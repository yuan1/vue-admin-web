{"version":3,"sources":["webpack:///./src/views/system/role/RoleEdit.vue?aeaa","webpack:///src/views/system/role/RoleEdit.vue","webpack:///./src/views/system/role/RoleEdit.vue?b9b8","webpack:///./src/views/system/role/RoleEdit.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticStyle","height","overflow","padding-bottom","attrs","title","maskClosable","width","placement","closable","visible","roleEditVisiable","on","close","onClose","form","_b","label","formItemLayout","directives","name","rawName","value","expression","readOnly","rules","max","message","rows","margin-bottom","validateStatus","menuSelectStatus","help","menuSelectHelp","key","menuTreeKey","ref","checkable","checkStrictly","defaultCheckedKeys","expandedKeys","treeData","menuTreeData","check","handleCheck","expand","handleExpand","staticClass","float","trigger","slot","click","expandAll","_v","closeAll","enableRelate","disableRelate","type","okText","cancelText","confirm","margin-right","loading","handleSubmit","staticRenderFns","labelCol","span","wrapperCol","RoleEditvue_type_script_lang_js_","props","default","roleInfoData","require","data","Date","$form","createForm","role","menuId","allTreeKeys","checkedKeys","methods","reset","resetFields","$emit","checkedArr","Object","is","checked","undefined","length","setFormValues","_ref","_this","assign","fields","keys","forEach","indexOf","getFieldDecorator","obj","setFieldsValue","_this2","validateFields","err","values","getFieldsValue","roleId","join","$put","objectSpread","then","r","catch","watch","_this3","$get","children","ids","splice","role_RoleEditvue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__"],"mappings":"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","file":"assets/js/chunk-2d0a463d.6bc79dae.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('a-drawer',{staticStyle:{\"height\":\"calc(100% - 55px)\",\"overflow\":\"auto\",\"padding-bottom\":\"53px\"},attrs:{\"title\":\"修改角色\",\"maskClosable\":false,\"width\":\"650\",\"placement\":\"right\",\"closable\":false,\"visible\":_vm.roleEditVisiable},on:{\"close\":_vm.onClose}},[_c('a-form',{attrs:{\"form\":_vm.form}},[_c('a-form-item',_vm._b({attrs:{\"label\":\"角色名称\"}},'a-form-item',_vm.formItemLayout,false),[_c('a-input',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['roleName']),expression:\"['roleName']\"}],attrs:{\"readOnly\":\"\"}})],1),_c('a-form-item',_vm._b({attrs:{\"label\":\"角色描述\"}},'a-form-item',_vm.formItemLayout,false),[_c('a-textarea',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:([\n      'remark',\n      {rules: [\n        { max: 50, message: '长度不能超过50个字符'}\n      ]}]),expression:\"[\\n      'remark',\\n      {rules: [\\n        { max: 50, message: '长度不能超过50个字符'}\\n      ]}]\"}],attrs:{\"rows\":4}})],1),_c('a-form-item',_vm._b({staticStyle:{\"margin-bottom\":\"2rem\"},attrs:{\"label\":\"权限选择\",\"validateStatus\":_vm.menuSelectStatus,\"help\":_vm.menuSelectHelp}},'a-form-item',_vm.formItemLayout,false),[_c('a-tree',{key:_vm.menuTreeKey,ref:\"menuTree\",attrs:{\"checkable\":true,\"checkStrictly\":_vm.checkStrictly,\"defaultCheckedKeys\":_vm.defaultCheckedKeys[0],\"expandedKeys\":_vm.expandedKeys,\"treeData\":_vm.menuTreeData},on:{\"check\":_vm.handleCheck,\"expand\":_vm.handleExpand}})],1)],1),_c('div',{staticClass:\"drawer-bootom-button\"},[_c('a-dropdown',{staticStyle:{\"float\":\"left\"},attrs:{\"trigger\":['click'],\"placement\":\"topCenter\"}},[_c('a-menu',{attrs:{\"slot\":\"overlay\"},slot:\"overlay\"},[_c('a-menu-item',{key:\"1\",on:{\"click\":_vm.expandAll}},[_vm._v(\"展开所有\")]),_c('a-menu-item',{key:\"2\",on:{\"click\":_vm.closeAll}},[_vm._v(\"合并所有\")]),_c('a-menu-item',{key:\"3\",on:{\"click\":_vm.enableRelate}},[_vm._v(\"父子关联\")]),_c('a-menu-item',{key:\"4\",on:{\"click\":_vm.disableRelate}},[_vm._v(\"取消关联\")])],1),_c('a-button',[_vm._v(\"\\n                树操作\\n                \"),_c('a-icon',{attrs:{\"type\":\"up\"}})],1)],1),_c('a-popconfirm',{attrs:{\"title\":\"确定放弃编辑？\",\"okText\":\"确定\",\"cancelText\":\"取消\"},on:{\"confirm\":_vm.onClose}},[_c('a-button',{staticStyle:{\"margin-right\":\".8rem\"}},[_vm._v(\"取消\")])],1),_c('a-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.loading},on:{\"click\":_vm.handleSubmit}},[_vm._v(\"提交\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <a-drawer\n            title=\"修改角色\"\n            :maskClosable=\"false\"\n            width=650\n            placement=\"right\"\n            :closable=\"false\"\n            @close=\"onClose\"\n            :visible=\"roleEditVisiable\"\n            style=\"height: calc(100% - 55px);overflow: auto;padding-bottom: 53px;\">\n        <a-form :form=\"form\">\n            <a-form-item label='角色名称' v-bind=\"formItemLayout\">\n                <a-input readOnly v-decorator=\"['roleName']\"/>\n            </a-form-item>\n            <a-form-item label='角色描述' v-bind=\"formItemLayout\">\n                <a-textarea\n                        :rows=\"4\"\n                        v-decorator=\"[\n          'remark',\n          {rules: [\n            { max: 50, message: '长度不能超过50个字符'}\n          ]}]\">\n                </a-textarea>\n            </a-form-item>\n            <a-form-item label='权限选择'\n                         style=\"margin-bottom: 2rem\"\n                         :validateStatus=\"menuSelectStatus\"\n                         :help=\"menuSelectHelp\"\n                         v-bind=\"formItemLayout\">\n                <a-tree\n                        :key=\"menuTreeKey\"\n                        ref=\"menuTree\"\n                        :checkable=\"true\"\n                        :checkStrictly=\"checkStrictly\"\n                        :defaultCheckedKeys=\"defaultCheckedKeys[0]\"\n                        @check=\"handleCheck\"\n                        @expand=\"handleExpand\"\n                        :expandedKeys=\"expandedKeys\"\n                        :treeData=\"menuTreeData\">\n                </a-tree>\n            </a-form-item>\n        </a-form>\n        <div class=\"drawer-bootom-button\">\n            <a-dropdown style=\"float: left\" :trigger=\"['click']\" placement=\"topCenter\">\n                <a-menu slot=\"overlay\">\n                    <a-menu-item key=\"1\" @click=\"expandAll\">展开所有</a-menu-item>\n                    <a-menu-item key=\"2\" @click=\"closeAll\">合并所有</a-menu-item>\n                    <a-menu-item key=\"3\" @click=\"enableRelate\">父子关联</a-menu-item>\n                    <a-menu-item key=\"4\" @click=\"disableRelate\">取消关联</a-menu-item>\n                </a-menu>\n                <a-button>\n                    树操作\n                    <a-icon type=\"up\"/>\n                </a-button>\n            </a-dropdown>\n            <a-popconfirm title=\"确定放弃编辑？\" @confirm=\"onClose\" okText=\"确定\" cancelText=\"取消\">\n                <a-button style=\"margin-right: .8rem\">取消</a-button>\n            </a-popconfirm>\n            <a-button @click=\"handleSubmit\" type=\"primary\" :loading=\"loading\">提交</a-button>\n        </div>\n    </a-drawer>\n</template>\n<script>\n    const formItemLayout = {\n        labelCol: {span: 3},\n        wrapperCol: {span: 18}\n    };\n    export default {\n        name: 'RoleEdit',\n        props: {\n            roleEditVisiable: {\n                default: false\n            },\n            roleInfoData: {\n                require: true\n            }\n        },\n        data() {\n            return {\n                menuTreeKey: +new Date(),\n                loading: false,\n                formItemLayout,\n                form: this.$form.createForm(this),\n                menuSelectStatus: '',\n                menuSelectHelp: '',\n                role: {\n                    menuId: ''\n                },\n                menuTreeData: [],\n                allTreeKeys: [],\n                checkedKeys: [],\n                defaultCheckedKeys: [],\n                expandedKeys: [],\n                checkStrictly: true\n            }\n        },\n        methods: {\n            reset() {\n                this.menuTreeKey = +new Date();\n                this.expandedKeys = [];\n                this.checkedKeys = [];\n                this.defaultCheckedKeys = [];\n                this.menuSelectStatus = this.menuSelectHelp = '';\n                this.loading = false;\n                this.form.resetFields()\n            },\n            onClose() {\n                this.reset();\n                this.$emit('close')\n            },\n            expandAll() {\n                this.expandedKeys = this.allTreeKeys\n            },\n            closeAll() {\n                this.expandedKeys = []\n            },\n            enableRelate() {\n                this.checkStrictly = false\n            },\n            disableRelate() {\n                this.checkStrictly = true\n            },\n            handleCheck(checkedKeys) {\n                this.checkedKeys = checkedKeys;\n                let checkedArr = Object.is(checkedKeys.checked, undefined) ? checkedKeys : checkedKeys.checked;\n                if (checkedArr.length) {\n                    this.menuSelectStatus = '';\n                    this.menuSelectHelp = ''\n                } else {\n                    this.menuSelectStatus = 'error';\n                    this.menuSelectHelp = '请选择相应的权限';\n                }\n            },\n            handleExpand(expandedKeys) {\n                this.expandedKeys = expandedKeys\n            },\n            setFormValues({...role}) {\n                let fields = ['roleName', 'remark'];\n                Object.keys(role).forEach((key) => {\n                    if (fields.indexOf(key) !== -1) {\n                        this.form.getFieldDecorator(key);\n                        let obj = {};\n                        obj[key] = role[key];\n                        this.form.setFieldsValue(obj)\n                    }\n                })\n            },\n            handleSubmit() {\n                let checkedArr = Object.is(this.checkedKeys.checked, undefined) ? this.checkedKeys : this.checkedKeys.checked;\n                if (checkedArr.length === 0) {\n                    this.menuSelectStatus = 'error';\n                    this.menuSelectHelp = '请选择相应的权限'\n                } else {\n                    this.form.validateFields((err, values) => {\n                        if (!err) {\n                            this.loading = true;\n                            let role = this.form.getFieldsValue();\n                            role.roleId = this.roleInfoData.roleId;\n                            role.menuId = checkedArr.join(',');\n                            this.$put('role', {\n                                ...role\n                            }).then((r) => {\n                                this.reset();\n                                this.$emit('success')\n                            }).catch(() => {\n                                this.loading = false\n                            })\n                        }\n                    })\n                }\n            }\n        },\n        watch: {\n            roleEditVisiable() {\n                if (this.roleEditVisiable) {\n                    this.$get('menu').then((r) => {\n                        this.menuTreeData = r.data.rows.children;\n                        this.allTreeKeys = r.data.ids;\n                        this.$get('role/menu/' + this.roleInfoData.roleId).then((r) => {\n                            this.defaultCheckedKeys.splice(0, this.defaultCheckedKeys.length, r.data);\n                            this.checkedKeys = r.data;\n                            this.expandedKeys = r.data;\n                            this.menuTreeKey = +new Date()\n                        })\n                    })\n                }\n            }\n        }\n    }\n</script>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RoleEdit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RoleEdit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./RoleEdit.vue?vue&type=template&id=593d42e0&\"\nimport script from \"./RoleEdit.vue?vue&type=script&lang=js&\"\nexport * from \"./RoleEdit.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}