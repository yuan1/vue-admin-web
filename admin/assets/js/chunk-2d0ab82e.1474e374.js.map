{"version":3,"sources":["webpack:///./src/views/personal/UpdateProfile.vue?70b0","webpack:///src/views/personal/UpdateProfile.vue","webpack:///./src/views/personal/UpdateProfile.vue?1c6c","webpack:///./src/views/personal/UpdateProfile.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticStyle","height","overflow","padding-bottom","attrs","title","maskClosable","width","placement","closable","visible","profileEditVisiable","on","close","onClose","form","_b","label","formItemLayout","directives","name","rawName","value","rules","type","message","max","expression","pattern","allowClear","dropdownStyle","maxHeight","treeData","deptTreeData","userDept","change","onDeptChange","required","_v","rows","staticClass","okText","cancelText","confirm","margin-right","loading","click","handleSubmit","staticRenderFns","labelCol","span","wrapperCol","UpdateProfilevue_type_script_lang_js_","props","default","data","$form","createForm","userId","roleId","status","username","computed","Object","objectSpread","vuex_esm","currentUser","state","account","user","methods","setUser","resetFields","$emit","setFormValues","_ref","_this","assign","fields","keys","forEach","key","indexOf","getFieldDecorator","obj","setFieldsValue","deptId","_this2","validateFields","err","values","getFieldsValue","$put","then","r","$get","concat","catch","watch","_this3","children","personal_UpdateProfilevue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__"],"mappings":"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","file":"assets/js/chunk-2d0ab82e.1474e374.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('a-drawer',{staticStyle:{\"height\":\"calc(100% - 55px)\",\"overflow\":\"auto\",\"padding-bottom\":\"53px\"},attrs:{\"title\":\"编辑资料\",\"maskClosable\":false,\"width\":\"650\",\"placement\":\"right\",\"closable\":false,\"visible\":_vm.profileEditVisiable},on:{\"close\":_vm.onClose}},[_c('a-form',{attrs:{\"form\":_vm.form}},[_c('a-form-item',_vm._b({attrs:{\"label\":\"邮箱\"}},'a-form-item',_vm.formItemLayout,false),[_c('a-input',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:([\n      'email',\n      {rules: [\n        { type: 'email', message: '请输入正确的邮箱' },\n        { max: 50, message: '长度不能超过50个字符'}\n      ]}\n    ]),expression:\"[\\n      'email',\\n      {rules: [\\n        { type: 'email', message: '请输入正确的邮箱' },\\n        { max: 50, message: '长度不能超过50个字符'}\\n      ]}\\n    ]\"}]})],1),_c('a-form-item',_vm._b({attrs:{\"label\":\"手机\"}},'a-form-item',_vm.formItemLayout,false),[_c('a-input',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['mobile', {rules: [\n        { pattern: '^0?(13[0-9]|15[012356789]|17[013678]|18[0-9]|14[57])[0-9]{8}$', message: '请输入正确的手机号'}\n      ]}]),expression:\"['mobile', {rules: [\\n        { pattern: '^0?(13[0-9]|15[012356789]|17[013678]|18[0-9]|14[57])[0-9]{8}$', message: '请输入正确的手机号'}\\n      ]}]\"}]})],1),_c('a-form-item',_vm._b({attrs:{\"label\":\"部门\"}},'a-form-item',_vm.formItemLayout,false),[_c('a-tree-select',{attrs:{\"allowClear\":true,\"dropdownStyle\":{ maxHeight: '220px', overflow: 'auto' },\"treeData\":_vm.deptTreeData,\"value\":_vm.userDept},on:{\"change\":_vm.onDeptChange}})],1),_c('a-form-item',_vm._b({attrs:{\"label\":\"性别\"}},'a-form-item',_vm.formItemLayout,false),[_c('a-radio-group',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:([\n        'ssex',\n        {rules: [{ required: true, message: '请选择性别' }]}\n      ]),expression:\"[\\n        'ssex',\\n        {rules: [{ required: true, message: '请选择性别' }]}\\n      ]\"}]},[_c('a-radio',{attrs:{\"value\":\"0\"}},[_vm._v(\"男\")]),_c('a-radio',{attrs:{\"value\":\"1\"}},[_vm._v(\"女\")]),_c('a-radio',{attrs:{\"value\":\"2\"}},[_vm._v(\"保密\")])],1)],1),_c('a-form-item',_vm._b({attrs:{\"label\":\"描述\"}},'a-form-item',_vm.formItemLayout,false),[_c('a-textarea',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:([\n      'description',\n      {rules: [\n        { max: 100, message: '长度不能超过100个字符'}\n      ]}]),expression:\"[\\n      'description',\\n      {rules: [\\n        { max: 100, message: '长度不能超过100个字符'}\\n      ]}]\"}],attrs:{\"rows\":4}})],1)],1),_c('div',{staticClass:\"drawer-bootom-button\"},[_c('a-popconfirm',{attrs:{\"title\":\"确定放弃编辑？\",\"okText\":\"确定\",\"cancelText\":\"取消\"},on:{\"confirm\":_vm.onClose}},[_c('a-button',{staticStyle:{\"margin-right\":\".8rem\"}},[_vm._v(\"取消\")])],1),_c('a-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.loading},on:{\"click\":_vm.handleSubmit}},[_vm._v(\"提交\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <a-drawer\n            title=\"编辑资料\"\n            :maskClosable=\"false\"\n            width=650\n            placement=\"right\"\n            :closable=\"false\"\n            @close=\"onClose\"\n            :visible=\"profileEditVisiable\"\n            style=\"height: calc(100% - 55px);overflow: auto;padding-bottom: 53px;\">\n        <a-form :form=\"form\">\n            <a-form-item label='邮箱' v-bind=\"formItemLayout\">\n                <a-input\n                        v-decorator=\"[\n          'email',\n          {rules: [\n            { type: 'email', message: '请输入正确的邮箱' },\n            { max: 50, message: '长度不能超过50个字符'}\n          ]}\n        ]\"/>\n            </a-form-item>\n            <a-form-item label=\"手机\" v-bind=\"formItemLayout\">\n                <a-input\n                        v-decorator=\"['mobile', {rules: [\n            { pattern: '^0?(13[0-9]|15[012356789]|17[013678]|18[0-9]|14[57])[0-9]{8}$', message: '请输入正确的手机号'}\n          ]}]\"/>\n            </a-form-item>\n            <a-form-item label='部门' v-bind=\"formItemLayout\">\n                <a-tree-select\n                        :allowClear=\"true\"\n                        :dropdownStyle=\"{ maxHeight: '220px', overflow: 'auto' }\"\n                        :treeData=\"deptTreeData\"\n                        @change=\"onDeptChange\"\n                        :value=\"userDept\">\n                </a-tree-select>\n            </a-form-item>\n            <a-form-item label='性别' v-bind=\"formItemLayout\">\n                <a-radio-group\n                        v-decorator=\"[\n            'ssex',\n            {rules: [{ required: true, message: '请选择性别' }]}\n          ]\">\n                    <a-radio value=\"0\">男</a-radio>\n                    <a-radio value=\"1\">女</a-radio>\n                    <a-radio value=\"2\">保密</a-radio>\n                </a-radio-group>\n            </a-form-item>\n            <a-form-item label='描述' v-bind=\"formItemLayout\">\n                <a-textarea\n                        :rows=\"4\"\n                        v-decorator=\"[\n          'description',\n          {rules: [\n            { max: 100, message: '长度不能超过100个字符'}\n          ]}]\">\n                </a-textarea>\n            </a-form-item>\n        </a-form>\n        <div class=\"drawer-bootom-button\">\n            <a-popconfirm title=\"确定放弃编辑？\" @confirm=\"onClose\" okText=\"确定\" cancelText=\"取消\">\n                <a-button style=\"margin-right: .8rem\">取消</a-button>\n            </a-popconfirm>\n            <a-button @click=\"handleSubmit\" type=\"primary\" :loading=\"loading\">提交</a-button>\n        </div>\n    </a-drawer>\n</template>\n<script>\n    import {mapState, mapMutations} from 'vuex'\n\n    const formItemLayout = {\n        labelCol: {span: 3},\n        wrapperCol: {span: 18}\n    }\n    export default {\n        props: {\n            profileEditVisiable: {\n                default: false\n            }\n        },\n        data() {\n            return {\n                formItemLayout,\n                form: this.$form.createForm(this),\n                deptTreeData: [],\n                userDept: [],\n                userId: '',\n                roleId: '',\n                status: '',\n                username: '',\n                loading: false\n            }\n        },\n        computed: {\n            ...mapState({\n                currentUser: state => state.account.user\n            })\n        },\n        methods: {\n            ...mapMutations({\n                setUser: 'account/setUser'\n            }),\n            onClose() {\n                this.loading = false;\n                this.form.resetFields();\n                this.$emit('close')\n            },\n            setFormValues({...user}) {\n                this.userId = user.userId;\n                let fields = ['email', 'ssex', 'description', 'mobile'];\n                Object.keys(user).forEach((key) => {\n                    if (fields.indexOf(key) !== -1) {\n                        this.form.getFieldDecorator(key);\n                        let obj = {};\n                        obj[key] = user[key];\n                        this.form.setFieldsValue(obj)\n                    }\n                });\n                if (user.deptId) {\n                    this.userDept = [user.deptId]\n                }\n                this.status = user.status;\n                this.roleId = user.roleId;\n                this.username = user.username\n            },\n            onDeptChange(value) {\n                this.userDept = value\n            },\n            handleSubmit() {\n                this.form.validateFields((err, values) => {\n                    if (!err) {\n                        this.loading = true;\n                        let user = this.form.getFieldsValue();\n                        user.userId = this.userId;\n                        user.deptId = this.userDept;\n                        user.roleId = this.roleId;\n                        user.status = this.status;\n                        user.username = this.username;\n                        this.$put('user/profile', {\n                            ...user\n                        }).then((r) => {\n                            this.loading = false;\n                            this.$emit('success');\n                            // 更新其state\n                            this.$get(`user/${user.username}`).then((r) => {\n                                this.setUser(r.data)\n                            })\n                        }).catch(() => {\n                            this.loading = false\n                        })\n                    }\n                })\n            }\n        },\n        watch: {\n            profileEditVisiable() {\n                if (this.profileEditVisiable) {\n                    this.$get('dept').then((r) => {\n                        this.deptTreeData = r.data.rows.children\n                    })\n                }\n            }\n        }\n    }\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UpdateProfile.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UpdateProfile.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UpdateProfile.vue?vue&type=template&id=95820df6&\"\nimport script from \"./UpdateProfile.vue?vue&type=script&lang=js&\"\nexport * from \"./UpdateProfile.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}